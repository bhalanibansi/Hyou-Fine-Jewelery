<!-- /sections/customer-account.liquid -->

<section class="account">
  <div class="wrapper">
    <div class="custom_acount_grid grid grid--account">
      {%- capture links -%}
 {% comment %} <ul>
    {%- assign needs_completion = true -%}
    {%- for block in section.blocks -%}
      {%- case block.type -%}

        {%- when '@app' -%}
          {% render block %}

        {%- when 'link' -%}
          <li {{ block.shopify_attributes }}><a href="{{ block.settings.link }}" rel="noopener" target="_blank">{{ block.settings.title }}</a></li>

        {%- when 'email' -%}
          {% assign default_text = 'customer.account.contact_store' | t %}
          {% assign default_email = shop.email %}
          <li {{ block.shopify_attributes }}><a href="mailto:{{ block.settings.email | default: default_email }}" rel="noopener" target="_blank">{{ block.settings.title | default: default_text }}</a></li>

        {%- when 'account' -%}
          {%- assign needs_completion = false -%}
          <li {% if template == 'customers/account' %} class="is-current"{% endif %}><a href="{{ routes.account_url }}">{{ 'customer.orders.title' | t }}</a></li>
          <li {% if template contains 'addresses' %} class="is-current"{% endif %}><a href="{{ routes.account_addresses_url }}">{{ 'customer.account.view_addresses' | t }}</a></li>
          <li>{{ 'layout.customer.log_out' | t | customer_logout_link }}</li>

      {%- endcase -%}
    {%- endfor -%}

    {%- if needs_completion -%}
      <li {% if template == 'customers/account' %} class="is-current"{% endif %}><a href="{{ routes.account_url }}">{{ 'customer.orders.title' | t }}</a></li>
      <li {% if template contains 'addresses' %} class="is-current"{% endif %}><a href="{{ routes.account_addresses_url }}">{{ 'customer.account.view_addresses' | t }}</a></li>
      <li>{{ 'layout.customer.log_out' | t | customer_logout_link }}</li>
    {%- endif -%}
  </ul>{% endcomment %}
{%- endcapture -%}

<aside class="account-sidebar">
  <div class="desktop">
    <div class="account-sidebar__title strong">
    {% comment %}<p>{{ 'customer.account.title' | t }}</p>  {% endcomment %}
   
        <ul>
        <li>{{ 'customer.account.title' | t }}</li>
    {%- assign needs_completion = true -%}
    {%- for block in section.blocks -%}
      {%- case block.type -%}
        
        {%- when '@app' -%}
          {% render block %}
        
        {%- when 'link' -%}
          <li {{ block.shopify_attributes }}><a href="{{ block.settings.link }}" rel="noopener" target="_blank">{{ block.settings.title }}</a></li>

        {%- when 'email' -%}
          {% assign default_text = 'customer.account.contact_store' | t %}
          {% assign default_email = shop.email %}
          <li {{ block.shopify_attributes }}><a href="mailto:{{ block.settings.email | default: default_email }}" rel="noopener" target="_blank">{{ block.settings.title | default: default_text }}</a></li>

        {%- when 'account' -%}
          {%- assign needs_completion = false -%}
          <li {% if template == 'customers/account' %} class="is-current"{% endif %}><a href="{{ routes.account_url }}">{{ 'customer.orders.title' | t }}</a></li>
          <li {% if template contains 'addresses' %} class="is-current"{% endif %}><a href="{{ routes.account_addresses_url }}">{{ 'customer.account.view_addresses' | t }}</a></li>
          <li>{{ 'layout.customer.log_out' | t | customer_logout_link }}</li>

      {%- endcase -%}
    {%- endfor -%}

    {%- if needs_completion -%}
      <li {% if template == 'customers/account' %} class="is-current"{% endif %}><a href="{{ routes.account_url }}">{{ 'customer.orders.title' | t }}</a></li>
      <li {% if template contains 'addresses' %} class="is-current"{% endif %}><a href="{{ routes.account_addresses_url }}">{{ 'customer.account.view_addresses' | t }}</a></li>
      <li>{{ 'layout.customer.log_out' | t | customer_logout_link }}</li>
    {%- endif -%}
  </ul>
       </div>
  </div>

  {% comment %}<div class="mobile">
    <collapsible-elements>
      <details data-collapsible>
        <summary data-collapsible-trigger>
          <p class="account-sidebar__title strong">
            {{ 'customer.account.title' | t }}
            {% render 'humberger-icon' %}
            {%- render 'icon-plus' -%}
            {%- render 'icon-minus' -%}
          </p>
        </summary>
        <div data-collapsible-body>
          <div data-collapsible-content>
            {{ links }}
          </div>
        </div>
      </details>
    </collapsible-elements>
  </div>{% endcomment %}
  
  <div class="mobile">
     <div class="account-sidebar mob-accordian">
      <div class="account-sidebar__title strong">
        <p class="accordion-header">{{ 'customer.account.title' | t }}
          {% render 'humberger-icon' %}
        </p>
        <ul class="accordion-content">
          <li>{{ 'customer.account.title' | t }}</li>
          {%- assign needs_completion = true -%}
          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- when '@app' -%}
                {% render block %}
              {%- when 'link' -%}
                <li {{ block.shopify_attributes }}><a href="{{ block.settings.link }}" rel="noopener" target="_blank">{{ block.settings.title }}</a></li>
              {%- when 'email' -%}
                {% assign default_text = 'customer.account.contact_store' | t %}
                {% assign default_email = shop.email %}
                <li {{ block.shopify_attributes }}><a href="mailto:{{ block.settings.email | default: default_email }}" rel="noopener" target="_blank">{{ block.settings.title | default: default_text }}</a></li>
              {%- when 'account' -%}
                {%- assign needs_completion = false -%}
                <li {% if template == 'customers/account' %} class="is-current"{% endif %}><a href="{{ routes.account_url }}">{{ 'customer.orders.title' | t }}</a></li>
                <li {% if template contains 'addresses' %} class="is-current"{% endif %}><a href="{{ routes.account_addresses_url }}">{{ 'customer.account.view_addresses' | t }}</a></li>
                <li>{{ 'layout.customer.log_out' | t | customer_logout_link }}</li>
            {%- endcase -%}
          {%- endfor -%}
    
          {%- if needs_completion -%}
            <li {% if template == 'customers/account' %} class="is-current"{% endif %}><a href="{{ routes.account_url }}">{{ 'customer.orders.title' | t }}</a></li>
            <li {% if template contains 'addresses' %} class="is-current"{% endif %}><a href="{{ routes.account_addresses_url }}">{{ 'customer.account.view_addresses' | t }}</a></li>
            <li>{{ 'layout.customer.log_out' | t | customer_logout_link }}</li>
          {%- endif -%}
        </ul>
      </div>
      {{ links }}
    </div>  
  </div>
</aside>


     {% comment %} <div class="account-main">
        <h2 class="page__heading">{{ 'customer.orders.title' | t }}</h2>
        {% paginate customer.orders by 20 %}
          {% if customer.orders.size != 0 %}
            <table>
              <thead>
                <tr>
                  <th class="order-number">{{ 'customer.orders.order_number' | t }}</th>
                  <th class="date">{{ 'customer.orders.date' | t }}</th>
                  <th class="payment-status">{{ 'customer.orders.payment_status' | t }}</th>
                  <th class="fulfillment-status">{{ 'customer.orders.fulfillment_status' | t }}</th>
                  <th class="total">{{ 'customer.orders.total' | t }}</th>
                </tr>
              </thead>
              <tbody>
                {% for order in customer.orders %}
                  <tr class="{% cycle 'odd', 'even' %} {% if order.cancelled %}cancelled_order{% endif %}">
                    <td class="order-number">
                      <span>{{ order.name | link_to: order.customer_url }}</span>
                    </td>
                    <td class="date"><span class="note">
                      <span>{{ order.created_at | date: format: 'full_date' }}</span>
                    </td>
                    <td class="payment-status">
                      <span>{{ order.financial_status_label }}</span>
                      {% if order.cancelled %}
                        {% assign order_cancelled_at = order.cancelled_at | date: format: 'full_date_and_time' %}
                        <p class="small highlight">
                          {{ 'customer.order.cancelled' | t: date: order_cancelled_at }}
                          <br>
                          {{ 'customer.order.cancelled_reason' | t: reason: order.cancel_reason }}
                        </p>
                      {% endif %}
                    </td>
                    <td class="fulfillment-status">
                      <span>{{ order.fulfillment_status_label }}</span>
                    </td>
                    <td class="total">
                      <span class="total money">
                        {%- if order.total_price == 0 -%}
                          {{ 'general.money.free' | t }}
                        {%- else -%}
                          {{ order.total_price | money_with_currency }}
                        {%- endif -%}
                      </span>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          {% else %}
            <p>{{ 'customer.orders.none' | t }}</p>
          {% endif %}

          {% render 'pagination', paginate: paginate %}

        {% endpaginate %}
      </div>{% endcomment %}
    </div>
  </div>
</section>

<style>
  /* Mobile view accordion styles */
  @media (max-width: 767px) {
    .accordion-content {
      display: none;
    }

    .accordion-header {
      cursor: pointer;
      background-color: #f1f1f1;
      padding: 10px;
      border: 1px solid #ccc;
    }

    .accordion-content li {
      padding: 10px;
      border-bottom: 1px solid #ccc;
    }
  }
  .mobile .account-sidebar .account-sidebar__title{
    padding: 0;
  }
  #Rise-account-page-button{
    display: none;
  }
  .mob-accordian .account-sidebar__title .accordion-content li{
    border-bottom: none;
  }
  .mob-accordian .account-sidebar__title .accordion-content li a{
    padding: 0;
  }
  .mob-accordian .account-sidebar__title .accordion-header{
    margin: 0;
  }
  .mob-accordian .account-sidebar__title .accordion-header svg{
    float: right;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const header = document.querySelector('.accordion-header');
    const content = document.querySelector('.accordion-content');

    // Initially hide the content
    content.style.display = 'none';

    // Toggle the accordion content visibility on click
    header.addEventListener('click', function() {
      if (content.style.display === 'none') {
        content.style.display = 'block';
      } else {
        content.style.display = 'none';
      }
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
  if (window.location.pathname === "/account") {
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
      event: "LOGIN_SUCCESS",
      device: /Mobi|Android|iPhone/i.test(navigator.userAgent) ? "mobile" : "desktop",
      utm: new URLSearchParams(window.location.search).get("utm_source") || "direct",
      timestamp: new Date().toISOString(),
      gtm_uniqueEventId: Date.now(),
      page_location: window.location.href,
      page_path: window.location.pathname,
      page_referrer: document.referrer || 'direct',
      locale: document.documentElement.lang || "en"
    });
  // alert("LOGIN_SUCCESS");
  }
});
</script>
{% schema %}
  {
    "name": "Account",
    "blocks": [
      {
        "type": "@app"
      },
      {
        "type": "account",
        "name": "Account links"
      },
      {
        "type": "email",
        "name": "Email link",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Email title",
            "default": "Support"
          },
          {
            "type": "text",
            "id": "link",
            "label": "Link",
            "info": "Leave blank to use the store email address"
          }
        ]
      },
      {
        "type": "link",
        "name": "Link",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Link title",
            "default": "Home"
          },
          {
            "type": "url",
            "id": "link",
            "label": "Link",
            "default": "/"
          }
        ]
      }
    ]
  }
{% endschema %}
